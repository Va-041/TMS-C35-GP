<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" >
<div th:fragment="sidebar">
    <div class="sidebar-card">
        <!-- Заголовок сайдбара с аватаркой -->
        <div class="sidebar-header">
            <img th:src="${user.avatarUrl ?: '/images/default-avatar.png'}"
                 class="user-avatar"
                 alt="Аватар пользователя"
                 onerror="this.src='/images/default-avatar.png'">
            <h3 class="user-name" th:text="${user.name ?: 'Пользователь'}"></h3>
            <span class="user-username" th:text="'@' + ${user.username}"></span>

            <!-- Статус профиля -->
            <div class="mt-3">
                <span th:if="${user.isPublicProfile}"
                      class="profile-status public">
                    <i class="bi bi-globe me-1"></i>Публичный
                </span>
                <span th:unless="${user.isPublicProfile}"
                      class="profile-status private">
                    <i class="bi bi-lock me-1"></i>Приватный
                </span>
            </div>

            <!-- Статистика в сайдбаре -->
            <div class="sidebar-stats mt-4">
                <div class="sidebar-stat">
                    <div class="stat-number-small" th:text="${statistic?.totalScore ?: 0}">0</div>
                    <div class="stat-label-small">Очки</div>
                </div>
                <div class="sidebar-stat">
                    <div class="stat-number-small" th:text="${statistic?.totalQuizzesPlayed ?: 0}">0</div>
                    <div class="stat-label-small">Игры</div>
                </div>
                <div class="sidebar-stat">
                    <div class="stat-number-small" th:text="${statistic?.totalQuizzesCreated ?: 0}">0</div>
                    <div class="stat-label-small">Викторины</div>
                </div>
            </div>
        </div>

        <!-- Навигация -->
        <div class="sidebar-nav">
            <!-- Обзор профиля -->
            <a class="nav-item-profile"
               th:href="@{/users/profile/main(tab='overview')}"
               th:classappend="${activeTab == 'overview'} ? 'active' : ''">
                <span class="nav-icon">
                    <i class="bi bi-house-door"></i>
                </span>
                <span>Обзор профиля</span>
            </a>

            <!-- Статистика -->
            <a class="nav-item-profile"
               th:href="@{/users/profile/main(tab='statistic')}"
               th:classappend="${activeTab == 'statistic'} ? 'active' : ''">
                <span class="nav-icon">
                    <i class="bi bi-bar-chart"></i>
                </span>
                <span>Статистика</span>
            </a>

            <!-- Мои викторины -->
            <a class="nav-item-profile"
               th:href="@{/users/profile/main(tab='my-quizzes')}"
               th:classappend="${activeTab == 'my-quizzes'} ? 'active' : ''">
                <span class="nav-icon">
                    <i class="bi bi-question-circle"></i>
                </span>
                <span>Мои викторины</span>
            </a>

            <!-- История игр -->
            <a class="nav-item-profile"
               th:href="@{/users/profile/main(tab='game-history')}"
               th:classappend="${activeTab == 'game-history'} ? 'active' : ''">
                <span class="nav-icon">
                    <i class="bi bi-clock-history"></i>
                </span>
                <span>История игр</span>
            </a>

            <!-- Друзья -->
            <a class="nav-item-profile"
               th:href="@{/users/profile/main(tab='friends')}"
               th:classappend="${activeTab == 'friends'} ? 'active' : ''">
                <span class="nav-icon">
                    <i class="bi bi-people"></i>
                </span>
                <span>Друзья</span>
            </a>

            <!-- Достижения -->
            <a class="nav-item-profile"
               th:href="@{/users/profile/main(tab='achievements')}"
               th:classappend="${activeTab == 'achievements'} ? 'active' : ''">
                <span class="nav-icon">
                    <i class="bi bi-trophy"></i>
                </span>
                <span>Достижения</span>
            </a>

            <!-- Активность -->
            <a class="nav-item-profile"
               th:href="@{/users/profile/main(tab='activity')}"
               th:classappend="${activeTab == 'activity'} ? 'active' : ''">
                <span class="nav-icon">
                    <i class="bi bi-activity"></i>
                </span>
                <span>Активность</span>
            </a>

            <!-- Настройки -->
            <a class="nav-item-profile"
               th:href="@{/users/profile/main(tab='settings')}"
               th:classappend="${activeTab == 'settings'} ? 'active' : ''">
                <span class="nav-icon">
                    <i class="bi bi-gear"></i>
                </span>
                <span>Настройки</span>
            </a>

            <!-- Быстрые действия -->
            <div class="sidebar-quick-actions mt-4 pt-3 border-top">
                <h6 class="sidebar-section-title">Быстрые действия</h6>

                <a class="quick-action-item" th:href="@{/quizzes/create}">
                    <span class="action-icon-small">
                        <i class="bi bi-plus-lg"></i>
                    </span>
                    <span>Создать викторину</span>
                </a>

                <a class="quick-action-item" th:href="@{/users/profile/main(tab='change-password')}">
                    <span class="action-icon-small">
                        <i class="bi bi-key"></i>
                    </span>
                    <span>Сменить пароль</span>
                </a>

                <a class="quick-action-item" th:href="@{/users/profile/main(tab='edit')}">
                    <span class="action-icon-small">
                        <i class="bi bi-pencil"></i>
                    </span>
                    <span>Редактировать профиль</span>
                </a>
            </div>
        </div>
    </div>
</div>

<!-- Стили для сайдбара -->
<style>
    /* Дополнительные стили для сайдбара */
    .sidebar-stats {
        display: flex;
        justify-content: space-around;
        gap: 1rem;
    }

    .sidebar-stat {
        text-align: center;
        flex: 1;
    }

    .stat-number-small {
        font-size: 1.5rem;
        font-weight: 700;
        color: #6d28d9;
        line-height: 1;
    }

    .stat-label-small {
        font-size: 0.8rem;
        color: #64748b;
        margin-top: 0.3rem;
    }

    .nav-badge {
        margin-left: auto;
        background: #e2e8f0;
        color: #1e293b;
        font-size: 0.75rem;
        font-weight: 600;
        padding: 0.2rem 0.6rem;
        border-radius: 10px;
        min-width: 20px;
        text-align: center;
    }

    .nav-badge.new {
        background: linear-gradient(135deg, #6d28d9 0%, #ec4899 100%);
        color: white;
    }

    .nav-badge.achievement {
        background: linear-gradient(135deg, #f59e0b 0%, #f97316 100%);
        color: white;
    }

    .sidebar-section-title {
        font-size: 0.9rem;
        font-weight: 600;
        color: #64748b;
        margin-bottom: 1rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
    }

    .quick-action-item {
        display: flex;
        align-items: center;
        gap: 0.75rem;
        padding: 0.7rem 1rem;
        border-radius: 12px;
        color: #64748b;
        text-decoration: none;
        transition: all 0.3s ease;
        margin-bottom: 0.5rem;
    }

    .quick-action-item:hover {
        background: rgba(109, 40, 217, 0.05);
        color: #6d28d9;
    }

    .action-icon-small {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: linear-gradient(135deg, #6d28d9 0%, #ec4899 100%);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
    }

    .status-indicator {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        margin-right: 0.5rem;
    }

    .status-indicator.online {
        background: #10b981;
        box-shadow: 0 0 0 2px rgba(16, 185, 129, 0.2);
    }

    .status-indicator.offline {
        background: #64748b;
        box-shadow: 0 0 0 2px rgba(100, 116, 139, 0.2);
    }

    .status-text {
        font-size: 0.9rem;
        color: #64748b;
    }

    .sidebar-progress-card {
        background: white;
        border-radius: 16px;
        padding: 1.2rem;
        border: 1px solid #e2e8f0;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
    }
</style>
</html>