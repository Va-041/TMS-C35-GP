<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<div th:fragment="my-quizzes">
  <div class="profile-card">
    <div class="profile-card-header">
      <h5 class="profile-card-title">
        <i class="bi bi-question-circle me-2"></i>Мои викторины
      </h5>
      <a th:href="@{/quizzes/create}" class="btn-profile btn-profile-primary btn-sm">
        <i class="bi bi-plus-lg me-1"></i>Создать викторину
      </a>
    </div>
    <div class="profile-card-body">
      <!-- Сообщение при отсутствии викторин -->
      <div th:if="${quizzes == null or quizzes.empty}" class="text-center text-muted py-5">
        <i class="bi bi-question-circle display-4 d-block mb-3 text-primary"></i>
        <h5>У вас пока нет созданных викторин</h5>
        <p class="mb-4">Создайте свою первую викторину и поделитесь ею с другими!</p>
        <a th:href="@{/quizzes/create}" class="btn-profile btn-profile-primary">
          <i class="bi bi-plus-lg me-1"></i>Создать первую викторину
        </a>
      </div>

      <!-- Список викторин -->
      <div th:unless="${quizzes == null or quizzes.empty}">
        <div class="row">
          <div th:each="quiz : ${quizzes}" class="col-lg-6 mb-4">
            <div class="card border-0 shadow-sm h-100">
              <div class="card-body d-flex flex-column">
                <div class="d-flex justify-content-between align-items-start mb-3">
                  <h6 class="card-title mb-0" th:text="${quiz.title}">Название викторины</h6>
                  <span th:if="${quiz.public}" class="badge-profile badge-success ms-2">
                                        <i class="bi bi-globe me-1"></i>Публичная
                                    </span>
                  <span th:unless="${quiz.public}" class="badge-profile badge-gray ms-2">
                                        <i class="bi bi-lock me-1"></i>Приватная
                                    </span>
                </div>

                <p class="card-text text-muted mb-3 flex-grow-1"
                   th:text="${quiz.description ?: 'Без описания'}">
                  Описание викторины
                </p>

                <div class="quiz-meta d-flex justify-content-between text-muted small mb-3">
                  <div class="meta-item">
                    <i class="bi bi-question-circle me-1"></i>
                    <span th:text="${quiz.questions != null ? quiz.questions.size() : 0}">0</span> вопросов
                  </div>
                  <div class="meta-item">
                    <i class="bi bi-calendar me-1"></i>
                    <span th:text="${#temporals.format(quiz.createdAt, 'dd.MM.yyyy')}">дата</span>
                  </div>
                  <div class="meta-item">
                    <i class="bi bi-clock me-1"></i>
                    <span th:text="${#temporals.format(quiz.createdAt, 'HH:mm')}">время</span>
                  </div>
                </div>

                <div class="d-flex gap-2 mt-auto">
                  <a th:href="@{'/quizzes/play/' + ${quiz.id}}"
                     class="btn-profile btn-profile-outline flex-grow-1">
                    <i class="bi bi-play-circle me-1"></i>Играть
                  </a>
                  <a th:href="@{'/quizzes/edit/' + ${quiz.id}}"
                     class="btn-profile btn-profile-primary">
                    <i class="bi bi-pencil"></i>
                  </a>
                  <a th:href="@{'/quizzes/delete/' + ${quiz.id}}"
                     class="btn-profile btn-profile-danger"
                     onclick="return confirm('Вы уверены, что хотите удалить эту викторину?')">
                    <i class="bi bi-trash"></i>
                  </a>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Статистика викторин - УПРОЩЕННАЯ ВЕРСИЯ -->
        <div class="profile-card mt-4">
          <div class="profile-card-header">
            <h6 class="profile-card-title">
              <i class="bi bi-bar-chart me-2"></i>Статистика викторин
            </h6>
          </div>
          <div class="profile-card-body">
            <div class="stats-grid">
              <div class="stat-card stat-card-primary">
                <div class="stat-icon">
                  <i class="bi bi-collection"></i>
                </div>
                <div class="stat-number" th:text="${quizzes.size()}">0</div>
                <div class="stat-label">Всего викторин</div>
              </div>

              <!-- Временно убираем сложные вычисления -->
              <div class="stat-card stat-card-success">
                <div class="stat-icon">
                  <i class="bi bi-globe"></i>
                </div>
                <div class="stat-number" th:text="${publicCount}">0</div>
                <div class="stat-label">Публичные</div>
              </div>

              <div class="stat-card stat-card-info">
                <div class="stat-icon">
                  <i class="bi bi-lock"></i>
                </div>
                <div class="stat-number" th:text="${privateCount}">0</div>
                <div class="stat-label">Приватные</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</html>